<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- CSS -->
    <link href="/static/main.css" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gamja+Flower&family=Jua&family=Nanum+Gothic+Coding&family=Noto+Sans+KR&display=swap"
          rel="stylesheet">
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
    <title>ì‹ë‹¹ë¦¬ìŠ¤íŠ¸í˜ì´ì§€</title>
    <script>
        $(document).ready(function(){

        })
        // ì‹ë‹¹ì •ë³´ í¬ë¡¤ë§
        function Searching() {

            let search = $("#keyword").val();
            $.ajax({
                type: "GET",
                url: "/search",
                data: {search_give: search},
                success: function (response) {
                    let rest_list = response['rest_lists']
                    for (let i = 0; i < rest_list.length; i++) {
                        let rest_name = rest_list[i]['rest_name']
                        let rest_tag = rest_list[i]['rest_tag']
                        let call = rest_list[i]['callNum']
                        let image = rest_list[i]['image']
                        let address = rest_list[i]['address']
                        let star = rest_list[i]['star']
                        let rest_url = rest_list[i]['rest_url']

                        // tempHTML
                        let temp_html = `
<div id="contentBox" class="contentBox">
        <div class="card restCard">
            <div class="restCardWrap">
            <img id="img-name" class="card-img-top"
                 src=${image}
                 alt="Card image cap">
            <div class="card-body restInfoCard">
                <a target="_blank" href="${rest_url}" class="card-title restName">${rest_name}</a>
                <p class="card-text star restStar">ë³„ì  : <span>${star}</span></p>
                <p class="card-text restCall"> ì „í™”ë²ˆí˜¸ : ${call}</p>
                <p class="card-text restAddress"> ì£¼ì†Œ : ${address}</p>
                <button id="btn-open-popup" class="btn btn-primary detailView"
                    onclick="detailPage('${rest_name},${rest_tag},${call},${image}, ${address},${star}')">${rest_name} ë”ë³´ê¸°</button>
            </div>
        </div>
</div>
`
                        $('#contentWrap').append(temp_html);

                    }

                }
            })
        }

        //ìƒì„¸í˜ì´ì§€ ì´ë™
        function detailPage(rest, tag, call, image, address, star) {
            let date = new Date()
            date.setTime(date.getTime() + 20 * 60 * 1000) // 20ë¶„
                        $.cookie('rest',rest,{expires : date})
                        {#$.cookie('tag',tag,{expires : date})#}
                        {#$.cookie('call',call,{expires : date})#}
                        {#$.cookie('image',image,{expires : date})#}
                        {#$.cookie('address',address,{expires : date})#}
                        {#$.cookie('star',star,{expires : date})#}
            window.location.href = "/detailView?info="+ $.cookie('rest')
                {#+"&tag="+$.cookie('tag')#}
                {#+"&call="+ $.cookie('call')#}
                {#+"&image="+ $.cookie('image')#}
                {#+"&address="+ $.cookie('address')#}
                {#+"&star="+ $.cookie('star')#}
        }


        //ë¡œê·¸ì•„ì›ƒ
        function to_logout() {
            $.removeCookie('my_token', {path: '/'});
            alert('ë¡œê·¸ì•„ì›ƒ í•©ë‹ˆë‹¤!!')
            window.location.href = "/login"
        }

        //ë¡œê·¸ì¸
        function to_login() {
            window.location.href = '/login'
        }
    </script>
</head>
<body>

<header>
    <!-- Logo -->
    <nav class="navbar is-fixed-top is-white" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="/">
                <img src="">
                <strong class="logo"
                        style="font-family: 'Stylish', sans-serif;font-size: larger;">ì±„ì‹ì˜ ê´‘ì¥</strong>
            </a>
        </div>
        <div class="login-info">
            {% if user_info %}
                <form class="form-inline userInfo">
                    <span class="mr-4"> {{ user_info.nickname }} ğŸ¥¦ |</span>
                    <button onclick="to_logout()" class="btn btn-outline-success my-2 my-sm-4 mr-4 logoutButton"
                            type="button">
                        ë¡œê·¸ì•„ì›ƒ
                    </button>
                </form>

            {% else %}
                <form class="form-inline userInfo">
                    <button onclick="to_login()" class="btn btn-outline-success my-2 my-sm-4 mr-4 logoutButton"
                            type="button">
                        ë¡œê·¸ì¸
                    </button>
                </form>
            {% endif %}
        </div>

    </nav>

</header>
<section>
    <!-- Title box -->
    <div class="titleBox">
        <p class="titleText titleText01">ì±„ì‹ì˜ ê´‘ì¥ ê°€ì´ë“œ</p>
        <p class="titleText titleText02">ì‹ë‹¹ì„ ë‹¤ë…€ì˜¨ ì±„ì‹ì´ë“¤ì´ ì„ ì •í•œ</p>
        <p class="titleText titleText03">ë² ìŠ¤íŠ¸ ì‹ë‹¹</p>
    </div>
    <!-- Search bar -->
    <div class="search-box d-flex justify-content-center">
        <input id="keyword" type="text" placeholder="êµ¬ ì´ë¦„ì„ì…ë ¥í•´ì£¼ì„¸ìš”" class="form-control" style="margin-right: 0.5rem ">
        <button class="btn btn-light" id="search" type="submit" onclick="Searching()">ê²€ìƒ‰</button>
    </div>
    <!--list -->
    <div id="contentWrap" class="contentWrap">
        <!-- í…ŒìŠ¤íŠ¸ì½”ë“œ -->
        <div id="contentBox" class="contentBox">
            <div class="card restCard">
                <div class="restCardWrap">
                    <img id="img-name" class="card-img-top"
                         src="https://cdn.imweb.me/upload/S201807105b444eb1364b5/f6ea0d46cb7c2.jpg"
                         alt="Card image cap">
                    <div class="card-body restInfoCard">
                        <a target="_blank" href="${rest_url}" class="card-title restName">ìƒëŸ¬ë“œë±…í¬</a>
                        <p class="card-text star restStar">ë³„ì  : <span>5.0</span></p>
                        <p class="card-text restCall"> ì „í™”ë²ˆí˜¸ : 070-1588-1588</p>
                        <p class="card-text restAddress"> ì£¼ì†Œ : ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ2ê¸¸ 45 1-1ì¸µì§€ë²ˆì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 517-5 1-1ì¸µì„œìš¸íŠ¹ë³„ì‹œ
                            ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ2ê¸¸ 45 1-1ì¸µì§€ë²ˆì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 517-5 1-1ì¸µ</p>
                        <button id="btn-open-popup" class="btn btn-primary detailView" onclick="detailPage()">
                            ìƒëŸ¬ë“œë±…í¬
                            ë”ë³´ê¸°
                        </button>
                    </div>
                </div>
            </div>
            <hr>
        </div>
        <div id="contentBox" class="contentBox">
            <div class="card restCard">
                <div class="restCardWrap">
                    <img id="img-name" class="card-img-top"
                         src="https://cdn.imweb.me/upload/S201807105b444eb1364b5/f6ea0d46cb7c2.jpg"
                         alt="Card image cap">
                    <div class="card-body restInfoCard">
                        <a target="_blank" href="${rest_url}" class="card-title restName">ìƒëŸ¬ë“œë±…í¬</a>
                        <p class="card-text star restStar">ë³„ì  : <span>5.0</span></p>
                        <p class="card-text restCall"> ì „í™”ë²ˆí˜¸ : 070-1588-1588</p>
                        <p class="card-text restAddress"> ì£¼ì†Œ : ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ2ê¸¸ 45 1-1ì¸µì§€ë²ˆì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 517-5 1-1ì¸µì„œìš¸íŠ¹ë³„ì‹œ
                            ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ2ê¸¸ 45 1-1ì¸µì§€ë²ˆì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 517-5 1-1ì¸µ</p>
                        <button id="btn-open-popup" class="btn btn-primary detailView" onclick="detailPage()">
                            ìƒëŸ¬ë“œë±…í¬
                            ë”ë³´ê¸°
                        </button>
                    </div>
                </div>
            </div>
            <hr>
        </div>
    </div>
</section>
</body>
</html>